import{r as o,a as v,j as t}from "./index-BwPJ5yJz.js";const T="_page_phhbs_1",$="_title_phhbs_15",y="_viewer_phhbs_22",E="_photo_phhbs_30",S="_photoSecret_phhbs_44",w="_photoRevealed_phhbs_48",H="_frame_phhbs_52",k="_image_phhbs_58",C="_imageBlurred_phhbs_65",I="_revealButton_phhbs_70",L="_secretHint_phhbs_97",A="_perforation_phhbs_110",G="_perforationTop_phhbs_119",O="_perforationBottom_phhbs_124",Q="_caption_phhbs_129",Y="_navButton_phhbs_135",q="_navButtonPrev_phhbs_166",z="_navButtonNext_phhbs_170",D="_counter_phhbs_174",e={page:T,title:$,viewer:y,photo:E,photoSecret:S,photoRevealed:w,frame:H,image:k,imageBlurred:C,revealButton:I,secretHint:L,perforation:A,perforationTop:G,perforationBottom:O,caption:Q,navButton:Y,navButtonPrev:q,navButtonNext:z,counter:D},F="#f6d5f7",X=({photos:l,onAccentChange:h})=>{const[g,B]=o.useState({}),[i,d]=o.useState(0),c=o.useRef(null),_=o.useRef(!1),r=o.useRef(null);o.useEffect(()=>(h(F),()=>{h(null)}),[h]),o.useEffect(()=>{if(!c.current)return;const n=v(c.current,{translateY:[16,0],opacity:[0,1],easing:"easeOutQuad",duration:420,complete:()=>{_.current=!1}});return()=>{n.pause()}},[i]),o.useEffect(()=>{i>=l.length&&d(0)},[i,l.length]),o.useEffect(()=>()=>{r.current&&clearTimeout(r.current)},[]);const a=l[i],s=l.length,f= n=>{B(p=>({...p,[n]:!0})),window.requestAnimationFrame(()=>{c.current&&v(c.current,{scale:[.95,1],rotate:[-1.2,0],duration:480,easing:"easeOutBack"})})},x= n=>{r.current&&clearTimeout(r.current),r.current=setTimeout(()=>{f(n),r.current=null},450)},N= n=>{r.current&&(clearTimeout(r.current),r.current=null,f(n))},R=()=>{r.current&&(clearTimeout(r.current),r.current=null)},b= n=>{if(s<=1||_.current)return;const p=c.current;if(!p){d(m=>(m+n+s)%s);return}_.current=!0,v(p,{opacity:[1,0],translateX:n>0?[0,-18]:[0,18],duration:220,easing:"easeInQuad",complete:()=>{d(m=>(m+n+s)%s)}})},j=()=>b(-1),P=()=>b(1),u=!a.revealable||g[a.id];return t.jsxs("div",{className:e.page,children:[t.jsx("h2",{className:e.title,children:"Фото і спогади"}),t.jsxs("div",{className:e.viewer,children:[t.jsx("button",{type:"button",className:`${e.navButton} ${e.navButtonPrev}`,onClick:j,disabled:s<=1,"aria-label":"Попереднє фото",children:"‹"}),t.jsxs("figure",{ref: n=>{c.current=n},className:`${e.photo} ${a.revealable?e.photoSecret:""} ${u?e.photoRevealed:""}`,children:[t.jsxs("div",{className:e.frame,children:[t.jsx("img",{src:a.src,alt:a.alt,loading:"lazy",decoding:"async",className:`${e.image} ${u?"":e.imageBlurred}`}),a.revealable&&!u&&t.jsxs("button",{type:"button",className:e.revealButton,onClick:()=>f(a.id),onPointerDown:()=>x(a.id),onPointerUp:()=>N(a.id),onPointerLeave:R,"aria-label":"Розкрити приховану історію",children:["Розкрити",t.jsx("span",{className:e.secretHint,children:"Торкнись і утримуй"})]}),t.jsx("span",{className:`${e.perforation} ${e.perforationTop}`,"aria-hidden":"true"}),t.jsx("span",{className:`${e.perforation} ${e.perforationBottom}`,"aria-hidden":"true"})]}),t.jsx("figcaption",{className:e.caption,children:u?a.hiddenCaption??a.caption:a.caption})]}),t.jsx("button",{type:"button",className:`${e.navButton} ${e.navButtonNext}`,onClick:P,disabled:s<=1,"aria-label":"Наступне фото",children:"›"})]}),t.jsxs("p",{className:e.counter,children:["Фото ",i+1," / ",s]})]})};export{X as default};
